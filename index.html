<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bienvenidos al juego del Ángel</title>
    <style>
        body {
            background-color: #d4f7d4; /* Fondo verde claro */
            font-family: Arial, sans-serif;
            text-align: center;
            padding: 20px;
        }
        h1 {
            color: red;
            text-align: center;
        }
        .container {
            margin-top: 20px;
        }
        input[type="text"] {
            padding: 10px;
            font-size: 16px;
            width: 300px;
            border: 2px solid #ccc;
            border-radius: 4px;
        }
        button {
            padding: 10px 20px;
            font-size: 16px;
            background-color: #4CAF50;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            margin-top: 20px;
        }
        button:hover {
            background-color: #45a049;
        }
        #resultado {
            margin-top: 20px;
            font-size: 18px;
            font-weight: bold;
        }
        #asignacionesList {
            margin-top: 20px;
            font-size: 16px;
        }
        .resetButton {
            margin-top: 10px;
        }
        .asignados {
            margin-top: 30px;
        }
        #resetearContainer, #resetJuegoContainer {
            margin-top: 20px;
            display: none; /* Inicialmente no mostrar estas secciones */
        }
    </style>
</head>
<body>

    <h1>Bienvenidos al juego del Ángel</h1>

    <div class="container">
        <label for="celular">Ingresa tu número de celular:</label>
        <input type="text" id="celular" placeholder="Ej. 1234567890">
        <div id="resultado"></div>
    </div>

    <div id="asignados" class="asignados">
        <h2>Nosotros ya jugamos y ya tenemos un ángel:</h2>
        <ul id="asignacionesList"></ul>
    </div>

    <div id="resetearContainer">
        <h3>Administrador (963852741):</h3>
        <label for="personaAResetear">Selecciona una persona para habilitar nuevamente:</label>
        <select id="personaAResetear">
            <option value="">Seleccionar...</option>
        </select>
        <button id="resetearButton" onclick="habilitarNuevamente()">Habilitar nuevamente</button>
    </div>

    <!-- Sección de reinicio del juego solo para el administrador -->
    <div id="resetJuegoContainer">
        <button id="resetJuegoButton" onclick="resetearJuego()">Resetear juego</button>
    </div>

    <script>
        // Lista de números y nombres asociados
        const listaNumeros = [
            { numero: '1234567890', nombre: 'Juan Pérez', asignado: false },
            { numero: '9876543210', nombre: 'Ana Gómez', asignado: false },
            { numero: '5551234567', nombre: 'Carlos Díaz', asignado: false },
            { numero: '2345678901', nombre: 'María López', asignado: false },
            { numero: '6789012345', nombre: 'Pedro González', asignado: false }
        ];

        // Variable para almacenar las asignaciones
        const asignaciones = [];

        // Función para verificar el número y mostrar el resultado
        function verificarNumero() {
            const numeroIngresado = document.getElementById('celular').value;
            const resultado = document.getElementById('resultado');
            const persona = listaNumeros.find(persona => persona.numero === numeroIngresado);

            // Limpiar el resultado anterior
            resultado.innerHTML = '';

            if (persona) {
                if (persona.asignado) {
                    // Si el número ya fue asignado
                    resultado.innerHTML = 'Disculpa, este número fue probado por otra persona. Por favor, dígalo al administrador para que habilite nuevamente su número.';
                } else {
                    // Si el número no ha sido asignado, asignar el ángel
                    resultado.innerHTML = `¡Hola, ${persona.nombre}!`;
                    mostrarBotonWhatsapp(persona);
                    persona.asignado = true; // Marcar como asignado
                }
            } else {
                // Si el número no coincide
                resultado.innerHTML = 'Número erróneo, por favor vuelve a digitarlo.';
            }

            // Verificar si el número ingresado es el del administrador
            if (numeroIngresado === '963852741') {
                document.getElementById('resetearContainer').style.display = 'block'; // Mostrar el contenedor de habilitar nuevamente
                document.getElementById('resetJuegoContainer').style.display = 'block'; // Mostrar el botón para resetear el juego
            } else {
                document.getElementById('resetearContainer').style.display = 'none'; // Ocultar el contenedor de habilitar nuevamente
                document.getElementById('resetJuegoContainer').style.display = 'none'; // Ocultar el botón para resetear el juego
            }
        }

        // Función para mostrar el botón de WhatsApp con el enlace único
        function mostrarBotonWhatsapp(persona) {
            const boton = document.createElement('button');
            boton.innerHTML = 'Sortear a mi Ángel';
            boton.onclick = function() {
                // Elegir un amigo al azar de la lista de personas
                const amigoOculto = elegirAmigoAlAzar(persona);

                // Crear el mensaje para WhatsApp
                const mensaje = `Hola ${persona.nombre}, te ha tocado el amigo oculto. Tu ángel es ${amigoOculto.nombre}. Shhh! No lo digas hasta el día escogido para entregar tu regalo. Ten un bendecido adviento de la natividad del niñito Jesús.`;

                // Crear el enlace de WhatsApp con el mensaje
                const enlaceWhatsapp = `https://wa.me/?text=${encodeURIComponent(mensaje)}`;
                window.open(enlaceWhatsapp, '_blank');

                // Guardar la asignación en la lista
                asignaciones.push({ persona: persona.nombre, angel: amigoOculto.nombre });

                // Actualizar la lista de asignados
                actualizarListaAsignados();
            };
            document.body.appendChild(boton);
        }

        // Función para elegir un amigo al azar de la lista de personas (excluyendo a la persona actual)
        function elegirAmigoAlAzar(personaActual) {
            // Crear una nueva lista sin la persona actual
            const listaSinActual = listaNumeros.filter(persona => persona.numero !== personaActual.numero && !persona.asignado);
            // Elegir un amigo aleatorio
            const indiceAleatorio = Math.floor(Math.random() * listaSinActual.length);
            const amigoOculto = listaSinActual[indiceAleatorio];
            amigoOculto.asignado = true; // Marcar como asignado
            return amigoOculto;
        }

        // Función para actualizar la lista de asignaciones
        function actualizarListaAsignados() {
            const lista = document.getElementById('asignacionesList');
            lista.innerHTML = '';
            asignaciones.forEach(asignacion => {
                const li = document.createElement('li');
                li.textContent = `${asignacion.persona} → ${asignacion.angel}`;
                lista.appendChild(li);
            });
        }

        // Función para mostrar la lista de personas para habilitar nuevamente
        function mostrarPersonasParaResetear() {
            const select = document.getElementById('personaAResetear');
            select.innerHTML = '<option value="">Seleccionar...</option>'; // Limpiar opciones anteriores
            listaNumeros.forEach(persona => {
                if (persona.asignado) {
                    const option = document.createElement('option');
                    option.value = persona.numero;
                    option.textContent = `${persona.nombre} (${perso
